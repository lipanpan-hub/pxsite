<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>李攀攀</title>
  
  <subtitle>李攀攀的博客</subtitle>
  <link href="http://lipanpanx.com/atom.xml" rel="self"/>
  
  <link href="http://lipanpanx.com/"/>
  <updated>2021-10-29T12:56:34.701Z</updated>
  <id>http://lipanpanx.com/</id>
  
  <author>
    <name>李攀攀</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>utools插件重载</title>
    <link href="http://lipanpanx.com/post/2021/utools%E6%8F%92%E4%BB%B6%E9%87%8D%E8%BD%BD"/>
    <id>http://lipanpanx.com/post/2021/utools%E6%8F%92%E4%BB%B6%E9%87%8D%E8%BD%BD</id>
    <published>2021-10-29T07:47:05.000Z</published>
    <updated>2021-10-29T12:56:34.701Z</updated>
    
    <content type="html"><![CDATA[<h4 id="utools插件开发-中-plugin.json-中的配置无法生效问题">utools插件开发 中 plugin.json 中的配置无法生效问题<a title="#utools插件开发-中-plugin.json-中的配置无法生效问题" href="#utools插件开发-中-plugin.json-中的配置无法生效问题"></a></h4><span id="more"></span><h2 id="0x01-需求">0x01 需求<a title="#0x01-需求" href="#0x01-需求"></a></h2><p>最近两天打算找个不限制流量, 不限制容量的 图床, 之前 我一直用阿里云的OSS, 太鸡儿贵了<br>因为我看到国外的不少图床 都是免费的 并且不限制容量和流量, 我太心动了</p><p>所以我打算把我国内的图床 换成国外的图床 然后在国内访问</p><p>想法有了之后 我就开始动手折腾了<br>把所有的图片上传到国外的图床, 然后通过代理服务器访问就好了</p><p>这就需要转链, 把原本图片的链接 转换成为 通过代理服务器访问的链接<br>所以我就需要搞个 utools工具  来帮助我方便的转链</p><h2 id="0x02-开搞">0x02 开搞<a title="#0x02-开搞" href="#0x02-开搞"></a></h2><p>挺久没有开发utools工具了 感觉utools的api 都忘得差不多了<br>这么久没有玩 utools也同1.x 升级到 2.x 了<br>不过插件的开发方式还是大同小异</p><p>开发过程挺顺利 不过中途遇到了几个坑, 我再这里记录一下</p><h3 id="utools-加载插件的方式变了">utools 加载插件的方式变了<a title="#utools-加载插件的方式变了" href="#utools-加载插件的方式变了"></a></h3><p>utools 1.x 可以直接加载插件 但是2.x 明显行不通</p><p>2.x 如果你想要加载插件 你就需要首先下载一个 <code>开发者工具</code> 插件 这是一个开发utools插件的 插件, 如下图:<br><img src="https://search.pstatic.net/common/?src=https://i.imgur.com/Ns7NmHj.png" alt="space" loading="lazy"></p><h3 id="utools-插件重载">utools 插件重载<a title="#utools-插件重载" href="#utools-插件重载"></a></h3><p>本次插件开发当中遇到的一个最为蛋疼的问题就是插件重载的问题</p><p>utools 识别不同插件是通过 一个plugin.json的文件<br>这个文件 里面 可以定义  什么时候 什么条件去唤醒 utools<br>我在里面搞了个 通过正则表达式去匹配链接的方式<br>就是说  当我 把国外的 图床上 图片的链接 粘贴到 utools的时候 utools 会用我写好的正则表达式 去尝试匹配这个链接<br>如果匹配成功  则utools 会调用我的插件 对 这个链接进行转链</p><p>但是中途发现一个问题 就是链接 怎么都无法匹配成功<br>我一度怀疑 是我的正则表达式有问题 导致无法成功匹配<br>最后调试来调试去 发现 我无论怎么改正则表达式 就是无法匹配, 我才开始怀疑utools</p><p><img src="https://search.pstatic.net/common/?src=https://i.imgur.com/ZKgSjT9.png" alt="space" loading="lazy" class="φbp"></p><p>我已经 把1处的开关打开了 按理说 每次我退出插件  插件的代码都会重载<br>我本以为  所有的代码都会自动更新</p><p>但是 其实 实际情况并不是我想想的那样 如果你改动的 是 plugin.json 当中的内容<br>plugin.json 是不会自动重载的  utools 开发工具的自动重载 仅仅重载你差价的逻辑代码 不会重载你的 plugin.json文件<br>这个文件 属于你的插件的配置文件</p><p>好鸡儿 蛋疼, 每次更改plugin.json 都需要 手动去重载 这个文件, 就是手动去按2处的 更新 按钮</p><h3 id="js正则表达式的坑">js正则表达式的坑<a title="#js正则表达式的坑" href="#js正则表达式的坑"></a></h3><p>还有个比较坑的问题就是js的 正则表达式的坑:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;text string&quot;</span>.match(<span class="regexp">/exp/</span>flags)</span><br></pre></td></tr></table></figure><p>我们使用 正则表达式的时候 一般会使用 不同的flag<br>js 的正则表达式 也有各种flag  有  <code>g  i m u y s</code> 等各种flag<br>但是在使用 match 函数的 时候 如果你的正则表达式使用的flag中有 <code>g</code> 这个flag<br>则match 函数返回的匹配数据当中 不包含 正则表达式匹配到的group数据</p><p>mdn 中的原文是这样的:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If the g flag is used, all results matching the complete regular expression will be returned, but capturing groups will not.</span><br><span class="line">if the g flag is not used, only the first complete match and its related capturing groups are returned. In this case, the returned item will have additional properties as described below.</span><br></pre></td></tr></table></figure><p>一旦你的正则表达式使用了这个g flag, 则match 函数就不会返回详细的匹配数据 就会导致 你比较难调试</p>]]></content>
    
    
    <summary type="html">&lt;h4 id=&quot;utools插件开发-中-plugin.json-中的配置无法生效问题&quot;&gt;utools插件开发 中 plugin.json 中的配置无法生效问题&lt;a title=&quot;#utools插件开发-中-plugin.json-中的配置无法生效问题&quot; href=&quot;#utools插件开发-中-plugin.json-中的配置无法生效问题&quot;&gt;&lt;/a&gt;&lt;/h4&gt;</summary>
    
    
    
    
    <category term="utools" scheme="http://lipanpanx.com/tags/utools/"/>
    
  </entry>
  
</feed>
