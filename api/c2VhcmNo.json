[{"title":"utools插件重载","date":"2021-10-29T07:47:05.000Z","date_formatted":{"ll":"2021年10月29日","L":"2021/10/29","MM-DD":"10-29"},"updated":"2021-10-29T12:56:34.701Z","content":"utools插件开发 中 plugin.json 中的配置无法生效问题\n\n0x01 需求\n最近两天打算找个不限制流量, 不限制容量的 图床, 之前 我一直用阿里云的OSS, 太鸡儿贵了\n因为我看到国外的不少图床 都是免费的 并且不限制容量和流量, 我太心动了\n所以我打算把我国内的图床 换成国外的图床 然后在国内访问\n想法有了之后 我就开始动手折腾了\n把所有的图片上传到国外的图床, 然后通过代理服务器访问就好了\n这就需要转链, 把原本图片的链接 转换成为 通过代理服务器访问的链接\n所以我就需要搞个 utools工具  来帮助我方便的转链\n0x02 开搞\n挺久没有开发utools工具了 感觉utools的api 都忘得差不多了\n这么久没有玩 utools也同1.x 升级到 2.x 了\n不过插件的开发方式还是大同小异\n开发过程挺顺利 不过中途遇到了几个坑, 我再这里记录一下\nutools 加载插件的方式变了\nutools 1.x 可以直接加载插件 但是2.x 明显行不通\n2.x 如果你想要加载插件 你就需要首先下载一个 开发者工具 插件 这是一个开发utools插件的 插件, 如下图:\n\nutools 插件重载\n本次插件开发当中遇到的一个最为蛋疼的问题就是插件重载的问题\nutools 识别不同插件是通过 一个plugin.json的文件\n这个文件 里面 可以定义  什么时候 什么条件去唤醒 utools\n我在里面搞了个 通过正则表达式去匹配链接的方式\n就是说  当我 把国外的 图床上 图片的链接 粘贴到 utools的时候 utools 会用我写好的正则表达式 去尝试匹配这个链接\n如果匹配成功  则utools 会调用我的插件 对 这个链接进行转链\n但是中途发现一个问题 就是链接 怎么都无法匹配成功\n我一度怀疑 是我的正则表达式有问题 导致无法成功匹配\n最后调试来调试去 发现 我无论怎么改正则表达式 就是无法匹配, 我才开始怀疑utools\n\n我已经 把1处的开关打开了 按理说 每次我退出插件  插件的代码都会重载\n我本以为  所有的代码都会自动更新\n但是 其实 实际情况并不是我想想的那样 如果你改动的 是 plugin.json 当中的内容\nplugin.json 是不会自动重载的  utools 开发工具的自动重载 仅仅重载你差价的逻辑代码 不会重载你的 plugin.json文件\n这个文件 属于你的插件的配置文件\n好鸡儿 蛋疼, 每次更改plugin.json 都需要 手动去重载 这个文件, 就是手动去按2处的 更新 按钮\njs正则表达式的坑\n还有个比较坑的问题就是js的 正则表达式的坑:\n1&quot;text string&quot;.match(/exp/flags)\n我们使用 正则表达式的时候 一般会使用 不同的flag\njs 的正则表达式 也有各种flag  有  g  i m u y s 等各种flag\n但是在使用 match 函数的 时候 如果你的正则表达式使用的flag中有 g 这个flag\n则match 函数返回的匹配数据当中 不包含 正则表达式匹配到的group数据\nmdn 中的原文是这样的:\n12If the g flag is used, all results matching the complete regular expression will be returned, but capturing groups will not.if the g flag is not used, only the first complete match and its related capturing groups are returned. In this case, the returned item will have additional properties as described below.\n一旦你的正则表达式使用了这个g flag, 则match 函数就不会返回详细的匹配数据 就会导致 你比较难调试\n","plink":"http://lipanpanx.com/post/2021/utools插件重载/"},{"title":"about","date":"2021-10-27T07:36:22.000Z","date_formatted":{"ll":"2021年10月27日","L":"2021/10/27","MM-DD":"10-27"},"updated":"2021-10-29T12:56:34.701Z","content":"这里是about页面\n","plink":"http://lipanpanx.com/about/"}]