[{"title":"utools插件重载问题","date":"2021-10-27T07:47:05.000Z","date_formatted":{"ll":"2021年10月27日","L":"2021/10/27","MM-DD":"10-27"},"updated":"2021-10-30T01:57:32.437Z","content":"utools插件开发 中 plugin.json 中的配置无法生效问题\n\n0x10 需求\n最近两天打算找个不限制流量, 不限制容量的 图床, 之前 我一直用阿里云的OSS, 太鸡儿贵了\n因为我看到国外的不少图床 都是免费的 并且不限制容量不限流量, 我太心动了\n所以我打算把我国内的图床 换成国外的图床 然后在国内访问\n想法有了之后 我就开始动手折腾了,把所有的图片上传到国外的图床, 然后通过代理服务器访问就好了\n这就需要转链, 把原本图片的链接 转换成为 通过代理服务器访问的链接,所以我就需要搞个 utools工具  来帮助我方便的转链\n0x20 开搞\n这么久没有玩 utools也从1.x 升级到 2.x 了\n不过插件的开发方式还是大同小异\n开发过程挺顺利 不过中途遇到了几个坑, 我再这里记录一下\n0x21 utools加载插件的方式变了\nutools 1.x 可以直接加载插件 但是2.x 明显行不通\n2.x 如果你想要加载插件 你就需要首先下载一个 开发者工具 插件 这是一个开发utools插件的 插件, 如下图:\n\n0x22 utools插件重载\n本次插件开发当中遇到的一个最为蛋疼的问题就是插件重载的问题\nutools 识别不同插件是通过 一个plugin.json的文件\n这个文件里面可以定义  在什么时候什么条件下去唤醒 utools\n我在里面写了个通过正则表达式去匹配链接的方式去唤醒我的插件\n也就是说当我把国外的图床上图片的链接粘贴到utools的时候,utools会用我写好的正则表达式去尝试匹配这个链接,如果匹配成功  则utools 会调用我的插件 对 这个链接进行转链\n但是中途发现一个问题 就是链接 怎么都无法匹配成功\n我一度怀疑是我的正则表达式有问题导致无法成功匹配\n最后调试来调试去 发现 我无论怎么改正则表达式 就是无法匹配, 我才开始怀疑utools\n\n我已经 图中① 处的开关打开了\n按理说每次我插件UI进入隐藏状态之后 插件就会完全退出 等我再次进入插件 插件的代码都会重载\n本来我以为所有的插件代码都会自动重载\n但是 其实 实际情况并不是我想想的那样 如果你改动的是插件的逻辑代码 当你打开 图中①处的开关时候,插件确实会重载 但是如果你改动的是plugin.json 当中的内容, plugin.json 是不会被自动重载的, utools开发工具的自动重载 仅仅重载你插件的逻辑代码 不会重载你的 plugin.json文件, 这个文件 属于你的插件的配置文件\n好鸡儿蛋疼, 每次更改plugin.json 都需要 手动去重载 这个文件, 就是手动去按图中② 处的更新按钮\n0x23 js正则表达式的坑\n还有个比较坑的问题就是js的 正则表达式的坑:\n1&quot;text string&quot;.match(/exp/flags)\n我们使用 正则表达式的时候 一般会使用 不同的flag\njs 的正则表达式 也有各种flag  有  g  i m u y s 等各种flag\n但是在使用 match 函数的 时候 如果你的正则表达式使用的flag中有 g 这个flag\n则match 函数返回的匹配数据当中 不包含正则表达式匹配到的group数据\nmdn 中的原文是这样的:\n12If the g flag is used, all results matching the complete regular expression will be returned, but capturing groups will not.if the g flag is not used, only the first complete match and its related capturing groups are returned. In this case, the returned item will have additional properties as described below.\n一旦你的正则表达式使用了这个g flag,\n则match 函数返回的就不是详细的匹配数据,而仅仅是一个匹配结果,这样的话不是很方便做细致的调试\n","plink":"http://lipanpanx.com/post/2021/utools插件重载/"},{"title":"关于我","date":"2021-10-27T07:36:22.000Z","date_formatted":{"ll":"2021年10月27日","L":"2021/10/27","MM-DD":"10-27"},"updated":"2021-10-30T01:57:32.437Z","content":"","plink":"http://lipanpanx.com/about/"}]